(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{134:function(n,e,t){"use strict";t.d(e,"a",(function(){return p})),t.d(e,"b",(function(){return b}));var r=t(0),a=t.n(r);function o(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function c(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach((function(e){o(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function i(n,e){if(null==n)return{};var t,r,a=function(n,e){if(null==n)return{};var t,r,a={},o=Object.keys(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var l=a.a.createContext({}),u=function(n){var e=a.a.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):c(c({},e),n)),t},p=function(n){var e=u(n.components);return a.a.createElement(l.Provider,{value:e},n.children)},d={inlineCode:"code",wrapper:function(n){var e=n.children;return a.a.createElement(a.a.Fragment,{},e)}},m=a.a.forwardRef((function(n,e){var t=n.components,r=n.mdxType,o=n.originalType,s=n.parentName,l=i(n,["components","mdxType","originalType","parentName"]),p=u(t),m=r,b=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return t?a.a.createElement(b,c(c({ref:e},l),{},{components:t})):a.a.createElement(b,c({ref:e},l))}));function b(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var o=t.length,s=new Array(o);s[0]=m;var c={};for(var i in e)hasOwnProperty.call(e,i)&&(c[i]=e[i]);c.originalType=n,c.mdxType="string"==typeof n?n:r,s[1]=c;for(var l=2;l<o;l++)s[l]=t[l];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},60:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return s})),t.d(e,"metadata",(function(){return c})),t.d(e,"rightToc",(function(){return i})),t.d(e,"default",(function(){return u}));var r=t(2),a=t(6),o=(t(0),t(134)),s={id:"examination",title:"\u9ad8\u9891\u771f\u9898\ud83d\udd25"},c={unversionedId:"javascript/examination",id:"javascript/examination",isDocsHomePage:!1,title:"\u9ad8\u9891\u771f\u9898\ud83d\udd25",description:"\u4e0a\u5e1d\uff08\u5f15\u64ce\uff09\u521b\u9020\u4e86\u4e9a\u5f53\uff08Object.prototype\uff09\uff0c\u6015\u4e9a\u5f53\u592a\u5b64\u5355\uff0c\u7528\u4ed6\u7684\u808b\u9aa8\u521b\u9020\u4e86\u590f\u5a03\uff08Function.prototype\uff0cFunction.prototype.proto === Object.prototype\uff09",source:"@site/docs/javascript/examination.md",slug:"/javascript/examination",permalink:"/docs/javascript/examination",editUrl:"https://github.com/Turkyden/edit/master/docs/javascript/examination.md",version:"current",sidebar:"someSidebar",previous:{title:"\u539f\u578b",permalink:"/docs/javascript/prototype"},next:{title:"Flex \u5e03\u5c40",permalink:"/docs/css/flex-layout"}},i=[{value:"1. \u9632\u6296",id:"1-\u9632\u6296",children:[]},{value:"2. \u8282\u6d41",id:"2-\u8282\u6d41",children:[]},{value:"3. new",id:"3-new",children:[]},{value:"4. bind",id:"4-bind",children:[]},{value:"5. call",id:"5-call",children:[]},{value:"6. apply",id:"6-apply",children:[]},{value:"7. deepCopy",id:"7-deepcopy",children:[]},{value:"8. \u4e8b\u4ef6\u603b\u7ebf | \u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f",id:"8-\u4e8b\u4ef6\u603b\u7ebf--\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f",children:[]},{value:"9. \u67ef\u91cc\u5316",id:"9-\u67ef\u91cc\u5316",children:[]},{value:"10. es5 \u5b9e\u73b0\u7ee7\u627f",id:"10-es5-\u5b9e\u73b0\u7ee7\u627f",children:[]},{value:"11. instanceof",id:"11-instanceof",children:[]},{value:"12. \u5f02\u6b65\u5e76\u53d1\u6570\u9650\u5236",id:"12-\u5f02\u6b65\u5e76\u53d1\u6570\u9650\u5236",children:[]},{value:"13. \u5f02\u6b65\u4e32\u884c | \u5f02\u6b65\u5e76\u884c",id:"13-\u5f02\u6b65\u4e32\u884c--\u5f02\u6b65\u5e76\u884c",children:[]},{value:"14. vue reactive",id:"14-vue-reactive",children:[]},{value:"15. promise",id:"15-promise",children:[]},{value:"16. \u6570\u7ec4\u6241\u5e73\u5316",id:"16-\u6570\u7ec4\u6241\u5e73\u5316",children:[]},{value:"17. \u5bf9\u8c61\u6241\u5e73\u5316",id:"17-\u5bf9\u8c61\u6241\u5e73\u5316",children:[]},{value:"18. \u56fe\u7247\u61d2\u52a0\u8f7d",id:"18-\u56fe\u7247\u61d2\u52a0\u8f7d",children:[]}],l={rightToc:i};function u(n){var e=n.components,t=Object(a.a)(n,["components"]);return Object(o.b)("wrapper",Object(r.a)({},l,t,{components:e,mdxType:"MDXLayout"}),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"\u4e0a\u5e1d\uff08\u5f15\u64ce\uff09\u521b\u9020\u4e86\u4e9a\u5f53\uff08Object.prototype\uff09\uff0c\u6015\u4e9a\u5f53\u592a\u5b64\u5355\uff0c\u7528\u4ed6\u7684\u808b\u9aa8\u521b\u9020\u4e86\u590f\u5a03\uff08Function.prototype\uff0cFunction.prototype.proto === Object.prototype\uff09")),Object(o.b)("h2",{id:"1-\u9632\u6296"},"1. \u9632\u6296"),Object(o.b)("p",null,"\u89e6\u53d1\u9ad8\u9891\u4e8b\u4ef6\u540e n \u79d2\u5185\u51fd\u6570\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\uff0c\u5982\u679c n \u79d2\u5185\u9ad8\u9891\u4e8b\u4ef6\u518d\u6b21\u88ab\u89e6\u53d1\uff0c\u5219\u91cd\u65b0\u8ba1\u7b97\u65f6\u95f4\u3002"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function debounce(func, ms = 1000) {\n  let timer;\n  return function (...args) {\n    if (timer) {\n      clearTimeout(timer)\n    }\n    timer = setTimeout(() => {\n      func.apply(this, args)\n    }, ms)\n  }\n}\n\n// \u6d4b\u8bd5\nconst task = () => { console.log('run task') }\nconst debounceTask = debounce(task, 1000)\nwindow.addEventListener('scroll', debounceTask)\n")),Object(o.b)("h2",{id:"2-\u8282\u6d41"},"2. \u8282\u6d41"),Object(o.b)("p",null,"\u9ad8\u9891\u4e8b\u4ef6\u89e6\u53d1\uff0c\u4f46\u5728 n \u79d2\u5185\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\uff0c\u6240\u4ee5\u8282\u6d41\u4f1a\u7a00\u91ca\u51fd\u6570\u7684\u6267\u884c\u9891\u7387\u3002"),Object(o.b)("p",null,Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://youtu.be/TBIEArmPywU?t=361"}),"\u67e5\u770b debounce \u548c throttle \u7684\u533a\u522b")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function throttle(func, ms = 1000) {\n  let canRun = true\n  return function (...args) {\n    if (!canRun) return\n    canRun = false\n    setTimeout(() => {\n      func.apply(this, args)\n      canRun = true\n    }, ms)\n  }\n}\n\n// \u6d4b\u8bd5\nconst task = () => { console.log('run task') }\nconst throttleTask = throttle(task, 1000)\nwindow.addEventListener('scroll', throttleTask)\n")),Object(o.b)("h2",{id:"3-new"},"3. new"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js",metastring:"{4}","{4}":!0}),'function myNew(Func, ...args) {\n  const instance = {};\n  if (Func.prototype) {\n    Object.setPrototypeOf(instance, Func.prototype)\n  }\n  const res = Func.apply(instance, args)\n  if (typeof res === "function" || (typeof res === "object" && res !== null)) {\n    return res\n  }\n  return instance\n}\n\n// \u6d4b\u8bd5\nfunction Person(name) {\n  this.name = name\n}\nPerson.prototype.sayName = function() {\n  console.log(`My name is ${this.name}`)\n}\nconst me = myNew(Person, \'Jack\')\nme.sayName()\nconsole.log(me)\n')),Object(o.b)("h2",{id:"4-bind"},"4. bind"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js",metastring:"{11}","{11}":!0}),"Function.prototype.myBind = function (context = globalThis) {\n  const fn = this\n  const args = Array.from(arguments).slice(1)\n  const newFunc = function () {\n    const newArgs = args.concat(...arguments)\n    if (this instanceof newFunc) {\n      // \u901a\u8fc7 new \u8c03\u7528\uff0c\u7ed1\u5b9a this \u4e3a\u5b9e\u4f8b\u5bf9\u8c61\n      fn.apply(this, newArgs)\n    } else {\n      // \u901a\u8fc7\u666e\u901a\u51fd\u6570\u5f62\u5f0f\u8c03\u7528\uff0c\u7ed1\u5b9a context\n      fn.apply(context, newArgs)\n    }\n  }\n  // \u652f\u6301 new \u8c03\u7528\u65b9\u5f0f\n  newFunc.prototype = Object.create(fn.prototype)\n  return newFunc\n}\n\n// \u6d4b\u8bd5\nconst me = { name: 'Jack' }\nconst other = { name: 'Jackson' }\nfunction say() {\n  console.log(`My name is ${this.name || 'default'}`);\n}\nconst meSay = say.myBind(me)\nmeSay()\nconst otherSay = say.myBind(other)\notherSay()\n")),Object(o.b)("h2",{id:"5-call"},"5. call"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"Function.prototype.myCall = function (context = globalThis) {\n  // \u5173\u952e\u6b65\u9aa4\uff0c\u5728 context \u4e0a\u8c03\u7528\u65b9\u6cd5\uff0c\u89e6\u53d1 this \u7ed1\u5b9a\u4e3a context\uff0c\u4f7f\u7528 Symbol \u9632\u6b62\u539f\u6709\u5c5e\u6027\u7684\u8986\u76d6\n  const key = Symbol('key')\n  context[key] = this\n  let args = [].slice.call(arguments, 1)\n  let res = context[key](...args)\n  delete context[key]\n  return res\n};\n\n// \u6d4b\u8bd5\nconst me = { name: 'Jack' }\nfunction say() {\n  console.log(`My name is ${this.name || 'default'}`);\n}\nsay.myCall(me)\n")),Object(o.b)("h2",{id:"6-apply"},"6. apply"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"Function.prototype.myApply = function (context = globalThis) {\n  // \u5173\u952e\u6b65\u9aa4\uff0c\u5728 context \u4e0a\u8c03\u7528\u65b9\u6cd5\uff0c\u89e6\u53d1 this \u7ed1\u5b9a\u4e3a context\uff0c\u4f7f\u7528 Symbol \u9632\u6b62\u539f\u6709\u5c5e\u6027\u7684\u8986\u76d6\n  const key = Symbol('key')\n  context[key] = this\n  let res\n  if (arguments[1]) {\n    res = context[key](...arguments[1])\n  } else {\n    res = context[key]()\n  }\n  delete context[key]\n  return res\n}\n\n// \u6d4b\u8bd5\nconst me = { name: 'Jack' }\nfunction say() {\n  console.log(`My name is ${this.name || 'default'}`);\n}\nsay.myApply(me)\n")),Object(o.b)("h2",{id:"7-deepcopy"},"7. deepCopy"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function deepCopy(obj, cache = new WeakMap()) {\n  if (!obj instanceof Object) return obj\n  // \u9632\u6b62\u5faa\u73af\u5f15\u7528\n  if (cache.get(obj)) return cache.get(obj)\n  // \u652f\u6301\u51fd\u6570\n  if (obj instanceof Function) {\n    return function () {\n      obj.apply(this, arguments)\n    }\n  }\n  // \u652f\u6301\u65e5\u671f\n  if (obj instanceof Date) return new Date(obj)\n  // \u652f\u6301\u6b63\u5219\u5bf9\u8c61\n  if (obj instanceof RegExp) return new RegExp(obj.source, obj.flags)\n  // \u8fd8\u53ef\u4ee5\u589e\u52a0\u5176\u4ed6\u5bf9\u8c61\uff0c\u6bd4\u5982\uff1aMap, Set\u7b49\uff0c\u6839\u636e\u60c5\u51b5\u5224\u65ad\u589e\u52a0\u5373\u53ef\uff0c\u9762\u8bd5\u70b9\u5230\u4e3a\u6b62\u5c31\u53ef\u4ee5\u4e86\n\n  // \u6570\u7ec4\u662f key \u4e3a\u6570\u5b57\u7d20\u94f6\u7684\u7279\u6b8a\u5bf9\u8c61\n  const res = Array.isArray(obj) ? [] : {}\n  // \u7f13\u5b58 copy \u7684\u5bf9\u8c61\uff0c\u7528\u4e8e\u5904\u7406\u5faa\u73af\u5f15\u7528\u7684\u60c5\u51b5\n  cache.set(obj, res)\n\n  Object.keys(obj).forEach((key) => {\n    if (obj[key] instanceof Object) {\n      res[key] = deepCopy(obj[key], cache)\n    } else {\n      res[key] = obj[key]\n    }\n  });\n  return res\n}\n\n// \u6d4b\u8bd5\nconst source = {\n  name: 'Jack',\n  meta: {\n    age: 12,\n    birth: new Date('1997-10-10'),\n    ary: [1, 2, { a: 1 }],\n    say() {\n      console.log('Hello');\n    }\n  }\n}\nsource.source = source\nconst newObj = deepCopy(source)\nconsole.log(newObj.meta.ary[2] === source.meta.ary[2]);\n")),Object(o.b)("h2",{id:"8-\u4e8b\u4ef6\u603b\u7ebf--\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f"},"8. \u4e8b\u4ef6\u603b\u7ebf | \u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"class EventEmitter {\n  constructor() {\n    this.cache = {}\n  }\n\n  on(name, fn) {\n    if (this.cache[name]) {\n      this.cache[name].push(fn)\n    } else {\n      this.cache[name] = [fn]\n    }\n  }\n\n  off(name, fn) {\n    const tasks = this.cache[name]\n    if (tasks) {\n      const index = tasks.findIndex((f) => f === fn || f.callback === fn)\n      if (index >= 0) {\n        tasks.splice(index, 1)\n      }\n    }\n  }\n\n  emit(name) {\n    if (this.cache[name]) {\n      // \u521b\u5efa\u526f\u672c\uff0c\u5982\u679c\u56de\u8c03\u51fd\u6570\u5185\u7ee7\u7eed\u6ce8\u518c\u76f8\u540c\u4e8b\u4ef6\uff0c\u4f1a\u9020\u6210\u6b7b\u5faa\u73af\n      const tasks = this.cache[name].slice()\n      for (let fn of tasks) {\n        fn();\n      }\n    }\n  }\n\n  emit(name, once = false) {\n    if (this.cache[name]) {\n      // \u521b\u5efa\u526f\u672c\uff0c\u5982\u679c\u56de\u8c03\u51fd\u6570\u5185\u7ee7\u7eed\u6ce8\u518c\u76f8\u540c\u4e8b\u4ef6\uff0c\u4f1a\u9020\u6210\u6b7b\u5faa\u73af\n      const tasks = this.cache[name].slice()\n      for (let fn of tasks) {\n        fn();\n      }\n      if (once) {\n        delete this.cache[name]\n      }\n    }\n  }\n}\n\n// \u6d4b\u8bd5\nconst eventBus = new EventEmitter()\nconst task1 = () => { console.log('task1'); }\nconst task2 = () => { console.log('task2'); }\neventBus.on('task', task1)\neventBus.on('task', task2)\n\nsetTimeout(() => {\n  eventBus.emit('task')\n}, 1000)\n")),Object(o.b)("h2",{id:"9-\u67ef\u91cc\u5316"},"9. \u67ef\u91cc\u5316"),Object(o.b)("p",null,"\u53ea\u4f20\u9012\u7ed9\u51fd\u6570\u4e00\u90e8\u5206\u53c2\u6570\u6765\u8c03\u7528\u5b83\uff0c\u8ba9\u5b83\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\u53bb\u5904\u7406\u5269\u4e0b\u7684\u53c2\u6570\u3002"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function curry(func) {\n  return function curried(...args) {\n    // \u5173\u952e\u77e5\u8bc6\u70b9\uff1afunction.length \u7528\u6765\u83b7\u53d6\u51fd\u6570\u7684\u5f62\u53c2\u4e2a\u6570\n    // \u8865\u5145\uff1aarguments.length \u83b7\u53d6\u7684\u662f\u5b9e\u53c2\u4e2a\u6570\n    if (args.length >= func.length) {\n      return func.apply(this, args)\n    }\n    return function (...args2) {\n      return curried.apply(this, args.concat(args2))\n    }\n  }\n}\n\n// \u6d4b\u8bd5\nfunction sum (a, b, c) {\n  return a + b + c\n}\nconst curriedSum = curry(sum)\nconsole.log(curriedSum(1, 2, 3))\nconsole.log(curriedSum(1)(2,3))\nconsole.log(curriedSum(1)(2)(3))\n")),Object(o.b)("h2",{id:"10-es5-\u5b9e\u73b0\u7ee7\u627f"},"10. es5 \u5b9e\u73b0\u7ee7\u627f"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function create(proto) {\n  function F() {}\n  F.prototype = proto;\n  return new F();\n}\n\n// Parent\nfunction Parent(name) {\n  this.name = name\n}\n\nParent.prototype.sayName = function () {\n  console.log(this.name)\n};\n\n// Child\nfunction Child(age, name) {\n  Parent.call(this, name)\n  this.age = age\n}\nChild.prototype = create(Parent.prototype)\nChild.prototype.constructor = Child\n\nChild.prototype.sayAge = function () {\n  console.log(this.age)\n}\n\n// \u6d4b\u8bd5\nconst child = new Child(18, 'Jack')\nchild.sayName()\nchild.sayAge()\n")),Object(o.b)("h2",{id:"11-instanceof"},"11. instanceof"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function isInstanceOf(instance, klass) {\n  let proto = instance.__proto__\n  let prototype = klass.prototype\n  while (true) {\n    if (proto === null) return false\n    if (proto === prototype) return true\n    proto = proto.__proto__\n  }\n}\n\n// \u6d4b\u8bd5\nclass Parent {}\nclass Child extends Parent {}\nconst child = new Child()\nconsole.log(isInstanceOf(child, Parent), isInstanceOf(child, Child), isInstanceOf(child, Array))\n")),Object(o.b)("h2",{id:"12-\u5f02\u6b65\u5e76\u53d1\u6570\u9650\u5236"},"12. \u5f02\u6b65\u5e76\u53d1\u6570\u9650\u5236"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"/**\n * \u5173\u952e\u70b9\n * 1. new promise \u4e00\u7ecf\u521b\u5efa\uff0c\u7acb\u5373\u6267\u884c\n * 2. \u4f7f\u7528 Promise.resolve().then \u53ef\u4ee5\u628a\u4efb\u52a1\u52a0\u5230\u5fae\u4efb\u52a1\u961f\u5217\uff0c\u9632\u6b62\u7acb\u5373\u6267\u884c\u8fed\u4ee3\u65b9\u6cd5\n * 3. \u5fae\u4efb\u52a1\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u4ea7\u751f\u7684\u65b0\u7684\u5fae\u4efb\u52a1\uff0c\u4f1a\u5728\u540c\u4e00\u4e8b\u4ef6\u5faa\u73af\u5185\uff0c\u8ffd\u52a0\u5230\u5fae\u4efb\u52a1\u961f\u5217\u91cc\n * 4. \u4f7f\u7528 race \u5728\u67d0\u4e2a\u4efb\u52a1\u5b8c\u6210\u65f6\uff0c\u7ee7\u7eed\u6dfb\u52a0\u4efb\u52a1\uff0c\u4fdd\u6301\u4efb\u52a1\u6309\u7167\u6700\u5927\u5e76\u53d1\u6570\u8fdb\u884c\u6267\u884c\n * 5. \u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u9700\u8981\u4ece doingTasks \u4e2d\u79fb\u51fa\n */\nfunction limit(count, array, iterateFunc) {\n  const tasks = []\n  const doingTasks = []\n  let i = 0\n  const enqueue = () => {\n    if (i === array.length) {\n      return Promise.resolve()\n    }\n    const task = Promise.resolve().then(() => iterateFunc(array[i++]))\n    tasks.push(task)\n    const doing = task.then(() => doingTasks.splice(doingTasks.indexOf(doing), 1))\n    doingTasks.push(doing)\n    const res = doingTasks.length >= count ? Promise.race(doingTasks) : Promise.resolve()\n    return res.then(enqueue)\n  };\n  return enqueue().then(() => Promise.all(tasks))\n}\n\n// test\nconst timeout = i => new Promise(resolve => setTimeout(() => resolve(i), i))\nlimit(2, [1000, 1000, 1000, 1000], timeout).then((res) => {\n  console.log(res)\n})\n")),Object(o.b)("h2",{id:"13-\u5f02\u6b65\u4e32\u884c--\u5f02\u6b65\u5e76\u884c"},"13. \u5f02\u6b65\u4e32\u884c | \u5f02\u6b65\u5e76\u884c"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// \u5b57\u8282\u9762\u8bd5\u9898\uff0c\u5b9e\u73b0\u4e00\u4e2a\u5f02\u6b65\u52a0\u6cd5\nfunction asyncAdd(a, b, callback) {\n  setTimeout(function () {\n    callback(null, a + b);\n  }, 500);\n}\n\n// \u89e3\u51b3\u65b9\u6848\n// 1. promisify\nconst promiseAdd = (a, b) => new Promise((resolve, reject) => {\n  asyncAdd(a, b, (err, res) => {\n    if (err) {\n      reject(err)\n    } else {\n      resolve(res)\n    }\n  })\n})\n\n// 2. \u4e32\u884c\u5904\u7406\nasync function serialSum(...args) {\n  return args.reduce((task, now) => task.then(res => promiseAdd(res, now)), Promise.resolve(0))\n}\n\n// 3. \u5e76\u884c\u5904\u7406\nasync function parallelSum(...args) {\n  if (args.length === 1) return args[0]\n  const tasks = []\n  for (let i = 0; i < args.length; i += 2) {\n    tasks.push(promiseAdd(args[i], args[i + 1] || 0))\n  }\n  const results = await Promise.all(tasks)\n  return parallelSum(...results)\n}\n\n// \u6d4b\u8bd5\n(async () => {\n  console.log('Running...');\n  const res1 = await serialSum(1, 2, 3, 4, 5, 8, 9, 10, 11, 12)\n  console.log(res1)\n  const res2 = await parallelSum(1, 2, 3, 4, 5, 8, 9, 10, 11, 12)\n  console.log(res2)\n  console.log('Done');\n})()\n")),Object(o.b)("h2",{id:"14-vue-reactive"},"14. vue reactive"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// Dep module\nclass Dep {\n  static stack = []\n  static target = null\n  deps = null\n  \n  constructor() {\n    this.deps = new Set()\n  }\n\n  depend() {\n    if (Dep.target) {\n      this.deps.add(Dep.target)\n    }\n  }\n\n  notify() {\n    this.deps.forEach(w => w.update())\n  }\n\n  static pushTarget(t) {\n    if (this.target) {\n      this.stack.push(this.target)\n    }\n    this.target = t\n  }\n\n  static popTarget() {\n    this.target = this.stack.pop()\n  }\n}\n\n// reactive\nfunction reactive(o) {\n  if (o && typeof o === 'object') {\n    Object.keys(o).forEach(k => {\n      defineReactive(o, k, o[k])\n    })\n  }\n  return o\n}\n\nfunction defineReactive(obj, k, val) {\n  let dep = new Dep()\n  Object.defineProperty(obj, k, {\n    get() {\n      dep.depend()\n      return val\n    },\n    set(newVal) {\n      val = newVal\n      dep.notify()\n    }\n  })\n  if (val && typeof val === 'object') {\n    reactive(val)\n  }\n}\n\n// watcher\nclass Watcher {\n  constructor(effect) {\n    this.effect = effect\n    this.update()\n  }\n\n  update() {\n    Dep.pushTarget(this)\n    this.value = this.effect()\n    Dep.popTarget()\n    return this.value\n  }\n}\n\n// \u6d4b\u8bd5\u4ee3\u7801\nconst data = reactive({\n  msg: 'aaa'\n})\n\nnew Watcher(() => {\n  console.log('===> effect', data.msg);\n})\n\nsetTimeout(() => {\n  data.msg = 'hello'\n}, 1000)\n")),Object(o.b)("h2",{id:"15-promise"},"15. promise"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// \u5efa\u8bae\u9605\u8bfb [Promises/A+ \u6807\u51c6](https://promisesaplus.com/)\nclass MyPromise {\n  constructor(func) {\n    this.status = 'pending'\n    this.value = null\n    this.resolvedTasks = []\n    this.rejectedTasks = []\n    this._resolve = this._resolve.bind(this)\n    this._reject = this._reject.bind(this)\n    try {\n      func(this._resolve, this._reject)\n    } catch (error) {\n      this._reject(error)\n    }\n  }\n\n  _resolve(value) {\n    setTimeout(() => {\n      this.status = 'fulfilled'\n      this.value = value\n      this.resolvedTasks.forEach(t => t(value))\n    })\n  }\n\n  _reject(reason) {\n    setTimeout(() => {\n      this.status = 'reject'\n      this.value = reason\n      this.rejectedTasks.forEach(t => t(reason))\n    })\n  }\n\n  then(onFulfilled, onRejected) {\n    return new MyPromise((resolve, reject) => {\n      this.resolvedTasks.push((value) => {\n        try {\n          const res = onFulfilled(value)\n          if (res instanceof MyPromise) {\n            res.then(resolve, reject)\n          } else {\n            resolve(res)\n          }\n        } catch (error) {\n          reject(error)\n        }\n      })\n      this.rejectedTasks.push((value) => {\n        try {\n          const res = onRejected(value)\n          if (res instanceof MyPromise) {\n            res.then(resolve, reject)\n          } else {\n            reject(res)\n          }\n        } catch (error) {\n          reject(error)\n        }\n      })\n    })\n  }\n\n  catch(onRejected) {\n    return this.then(null, onRejected);\n  }\n}\n\n// \u6d4b\u8bd5\nnew MyPromise((resolve) => {\n  setTimeout(() => {\n    resolve(1);\n  }, 500);\n}).then((res) => {\n    console.log(res);\n    return new MyPromise((resolve) => {\n      setTimeout(() => {\n        resolve(2);\n      }, 500);\n    });\n  }).then((res) => {\n    console.log(res);\n    throw new Error('a error')\n  }).catch((err) => {\n    console.log('==>', err);\n  })\n")),Object(o.b)("h2",{id:"16-\u6570\u7ec4\u6241\u5e73\u5316"},"16. \u6570\u7ec4\u6241\u5e73\u5316"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// \u65b9\u6848 1\nfunction recursionFlat(ary = []) {\n  const res = []\n  ary.forEach(item => {\n    if (Array.isArray(item)) {\n      res.push(...recursionFlat(item))\n    } else {\n      res.push(item)\n    }\n  })\n  return res\n}\n// \u65b9\u6848 2\nfunction reduceFlat(ary = []) {\n  return ary.reduce((res, item) => res.concat(Array.isArray(item) ? reduceFlat(item) : item), [])\n}\n\n// \u6d4b\u8bd5\nconst source = [1, 2, [3, 4, [5, 6]], '7']\nconsole.log(recursionFlat(source))\nconsole.log(reduceFlat(source))\n")),Object(o.b)("h2",{id:"17-\u5bf9\u8c61\u6241\u5e73\u5316"},"17. \u5bf9\u8c61\u6241\u5e73\u5316"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"function objectFlat(obj = {}) {\n  const res = {}\n  function flat(item, preKey = '') {\n    Object.entries(item).forEach(([key, val]) => {\n      const newKey = preKey ? `${preKey}.${key}` : key\n      if (val && typeof val === 'object') {\n        flat(val, newKey)\n      } else {\n        res[newKey] = val\n      }\n    })\n  }\n  flat(obj)\n  return res\n}\n\n// \u6d4b\u8bd5\nconst source = { a: { b: { c: 1, d: 2 }, e: 3 }, f: { g: 2 } }\nconsole.log(objectFlat(source));\n")),Object(o.b)("h2",{id:"18-\u56fe\u7247\u61d2\u52a0\u8f7d"},"18. \u56fe\u7247\u61d2\u52a0\u8f7d"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// <img src=\"default.png\" data-src=\"https://xxxx/real.png\">\nfunction isVisible(el) {\n  const position = el.getBoundingClientRect()\n  const windowHeight = document.documentElement.clientHeight\n  // \u9876\u90e8\u8fb9\u7f18\u53ef\u89c1\n  const topVisible = position.top > 0 && position.top < windowHeight;\n  // \u5e95\u90e8\u8fb9\u7f18\u53ef\u89c1\n  const bottomVisible = position.bottom < windowHeight && position.bottom > 0;\n  return topVisible || bottomVisible;\n}\n\nfunction imageLazyLoad() {\n  const images = document.querySelectorAll('img')\n  for (let img of images) {\n    const realSrc = img.dataset.src\n    if (!realSrc) continue\n    if (isVisible(img)) {\n      img.src = realSrc\n      img.dataset.src = ''\n    }\n  }\n}\n\n// \u6d4b\u8bd5\nwindow.addEventListener('load', imageLazyLoad)\nwindow.addEventListener('scroll', imageLazyLoad)\n// or\nwindow.addEventListener('scroll', throttle(imageLazyLoad, 1000))\n")))}u.isMDXComponent=!0}}]);